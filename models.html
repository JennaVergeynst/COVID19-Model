

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Introduction &mdash; covid19-model  documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="How to use the model" href="application.html" />
    <link rel="prev" title="Git workflow" href="git_workflow.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> covid19-model
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="collaborate.html">Start to collaborate</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_workflow.html">Git workflow</a></li>
</ul>
<p class="caption"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#the-model">The model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-dynamics">Model dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-framework-and-equations">Model framework and equations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#age-stratification">Age-stratification</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deterministic-framework">Deterministic framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stochastic-framework">Stochastic framework</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#stochastic-spatial-framework">Stochastic spatial framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transmission-rates-and-social-contact-data">Transmission rates and social contact data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modeling-social-intertia">Modeling social intertia</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-reproduction-number">Basic reproduction number</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-parameters">Model parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="application.html">Run the model</a></li>
<li class="toctree-l1"><a class="reference internal" href="previous_work.html">Previous work</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Future work</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">covid19-model</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Introduction</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/models.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>After an initial outbreak in early 2020 in Wuhan, China, Severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) has spread globally. SARS-CoV-2 is capable of sustained human-to-human trans-
mission, and may cause severe disease, especially in older individuals. The COVID-19 pandemic has, in general, shown a remarkedly low incidence among children and young adults. Children have a lower susceptibility to infection and a lower propensity to show clinical symptoms. Furthermore, pre-symptomatic transmission is a major contributor to SARS-CoV-2 spread.
Unfortunately, pharmaceutical interventions such as vaccination and antiviral drugs are not yet available. On March 13th, 2020, the Belgian governments imposed strict social restrictions after tracing methods had failed to prevent large-scale spread of SARS-CoV-2. One and a half months later, the curve was succesfully flattened and social restrictions were gradually relaxed during the months of May, June and the beginning of July. In spite of these relaxations, hospitalizations kept declining. It is expected that during the coming year(s), preventing COVID-19 outbreaks will depend mostly on the successful implementation of non-pharmaceutical interventions such as social distancing, testing, contact tracing and quarantine. Hence the need for well-informed models that can assist policymakers in choosing the best non-pharmaceutical interventions in case of another large-scale SARS-CoV-2 outbreak. Currently, two other models exist to make predictions for Belgium, the agent-based model of Willem et al. and the discrete-time, stochastic metapopulation model of Coletti et al.</p>
<p>We built a deterministic, continuous-time, age-stratified, extended SEIRD model and calibrated it to national Belgian hospitalization data. The model accounts for pre-symptomatic and asymptomatic transmission. Furthermore, the susceptibility to SARS-CoV-2, the severity of the disease and the susceptibility to a subclinical infection depend on the age of the individual. We used social contact rates from a 2012 study by Willem to model age-specific social mixing. Because detailed hospitalization data are not made publicly available by the Belgian Scientific Institute of Public Health (Sciensano), we derived age-stratified hospitalization parameters from data of 370 patients treated in two Ghent (Belgium) hospitals. To overcome this unconstructive data policy, we used the computed hospitalization parameters as temporary proxies to fit the model to the total number of patients in Belgian hospitals and ICU units. Using the model, we computed the basic reproduction number (<span class="math notranslate nohighlight">\(R_0\)</span>) during the March 2020 epidemic. Because the model systematically overestimates the hospitalizations during lockdown relaxation, we re-estimated the basic reproduction using data from May 2020 until July 2020.</p>
</div>
<div class="section" id="the-model">
<h1>The model<a class="headerlink" href="#the-model" title="Permalink to this headline">¶</a></h1>
<div class="section" id="model-dynamics">
<h2>Model dynamics<a class="headerlink" href="#model-dynamics" title="Permalink to this headline">¶</a></h2>
<p>The SEIR(D) model was first proposed in 1929 by two Scottish scientists. It is a compartmental model that subdivides the human population into four groups: 1) susceptible individuals, 2) exposed individuals in the latent phase 1, 3) infectious individuals capable of transmitting the disease and 4) individuals removed from the population either through immunization or death. Despite being a simple and idealized reality, the SEIR(D) dynamics are used extensively to predict the outbreak of infectious diseases and this was no different during the SARS-CoV-2 outbreak earlier this year.</p>
<p>In this work, we extend the SEIRD model to incorporate more expert knowledge on SARS-CoV-2. For that purpose, the infectious compartment is split into four parts. The first is a period of presymptomatic infectiousness because several studies have shown that pre-symptomatic transmission is a dominant transmission mechanism of SARS-CoV-2. After the period of pre-symptomatic transmission, three possible infectious outcomes are modeled: (1) Asymptomatic outcome, for individuals who show no symptoms at all, (2) Mild outcome, for individuals with mild symptoms who recover at home, and (3) Hospitalization, when mild symptoms worsen. Children and young adults have a high propensity to experience an asymptomatic or mild outcome, while older individual have a high propensity to be hospitalized.</p>
<p>In general, Belgian hospitals have two wards for COVID-19 patients: 1) Cohort, where patients are not monitored permanently and 2) Intensive care, for patients with the most severe symptoms. Intensive care includes permanent monitoring, the use of ventilators or the use of extracorporeal membrane oxygenation (ECMO). Patients generally spend limited time in the emergency room and/or in a buffer ward before going to Cohort. After spending limited time in Cohort, some patients are transferred to ICU. Patients can perish in both wards, but mortalities are generally lower in Cohort. After a stay in an ICU, patients return to Cohort for recovery in the hospital. During the recovery stay, mortality is limited. The above is a short summary of hospital dynamics based on interviewing Ghent University hospital staff and examining the hospital data.</p>
<p align="center">
<img src="_static/figs/flowchart_full.png" alt="drawing" width="600"/>
<p><em> Extended SEIRD dynamics of the BIOMATH COVID-19 model. Nodes represent model states, edges denote transfers. An overview of the model parameters can be found on the bottom of this page.</em></p>
</p>
</div>
<div class="section" id="model-framework-and-equations">
<h2>Model framework and equations<a class="headerlink" href="#model-framework-and-equations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="age-stratification">
<h3>Age-stratification<a class="headerlink" href="#age-stratification" title="Permalink to this headline">¶</a></h3>
<p>We introduced heterogeneity in the deterministic implementation by means of age-stratification. Every population compartment is split into a number of age classes, the age-groups have different contact rates with other age-groups and the disease progresses differently for each age-group, making the model behaviour more realistic. Our age-stratified model consists of 9 age classes, i.e., [0-10[, [10-20[, [20-30[, [30-40[, [40-50[, [50-60[, [60-70[, [70-80[, [80- <span class="math notranslate nohighlight">\(\infty\)</span>[. The age-stratified implementation provides a good balance between added complexity and computational resources.</p>
</div>
<div class="section" id="deterministic-framework">
<h3>Deterministic framework<a class="headerlink" href="#deterministic-framework" title="Permalink to this headline">¶</a></h3>
<p>Our extended SEIRD model is implemented using two frameworks: a deterministic and a stochastic framework. The deterministic equations are obtained by writing down the following equation,</p>
<p><code class="docutils literal notranslate"><span class="pre">rate</span> <span class="pre">of</span> <span class="pre">change</span> <span class="pre">=</span> <span class="pre">in</span> <span class="pre">-</span> <span class="pre">out</span></code>,</p>
<p>for every of the 11 population compartments. This results in the following system of coupled ordinary differential equations,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{S_i} &amp;=&amp; - \beta s_i \sum_{j=1}^{N} N_{c,ij} S_j \Big( \frac{I_j+A_j}{T_j} \Big) + \zeta R_i, \\
\dot{E_i} &amp;=&amp; \beta s_i \sum_{j=1}^{N} N_{c,ij} S_j \Big( \frac{I_j+A_j}{T_j} \Big) - (1/\sigma) \cdot E_i,  \\ 
\dot{I_i} &amp;=&amp; (1/\sigma) E_i - (1/\omega) I_i, \\
\dot{A_i} &amp;=&amp; (\text{a}_i/\omega) I_i - (1/d_{\text{a}}) A_i, \\ 
\dot{M_i} &amp;=&amp;  ((1-\text{a}_i) / \omega ) I_i - ( (1-h_i)/d_m + h_i/d_{\text{hospital}} ) M_i, \\
\dot{ER_i} &amp;=&amp; (h_i/d_{\text{hospital}}) M_i - (1/d_{\text{ER}}) ER_i, \\
\dot{C_i} &amp;=&amp; c_i (1/d_{\text{ER}}) ER_i  - (m_{C, i}/d_{c,D}) C_i - ((1 - m_{C, i})/d_{c,R}) C_i, \\
\dot{ICU_i} &amp;=&amp; (1-c_i) (1/d_{\text{ER}}) ER_i - (m_{ICU,i}/d_{\text{ICU},D}) ICU_i  \\
&amp;&amp; - ((1-m_{ICU,i})/d_{\text{ICU},R}) ICU_i,\\
\dot{C}_{\text{ICU,rec,i}} &amp;=&amp; ((1-m_{ICU,i})/d_{\text{ICU},R}) ICU_i - (1/d_{\text{ICU,rec}}) C_{\text{ICU,rec,i}}, \\
\dot{D_i} &amp;=&amp;  (m_{ICU,i}/d_{\text{ICU},D}) ICU_i +  (m_{C,i}/d_{\text{c},D}) C_i , \\
\dot{R_i} &amp;=&amp;  (1/d_a) A_i + ((1-h_i)/d_m) M_i + ((1-m_{C,i})/d_{c,R}) C_i \\
&amp;&amp; + (1/d_{\text{ICU,rec}}) C_{\text{ICU,rec,i}} - \zeta R_i,
\end{eqnarray}
\end{split}\]</div>
<p>for <span class="math notranslate nohighlight">\(i = 1,2,...,9\)</span>. Here, <span class="math notranslate nohighlight">\(T_i\)</span> stands for total population, <span class="math notranslate nohighlight">\(S_i\)</span> stands for susceptible, <span class="math notranslate nohighlight">\(E_i\)</span> for exposed, <span class="math notranslate nohighlight">\(I_i\)</span> for pre-symptomatic and infectious, <span class="math notranslate nohighlight">\(A_i\)</span> for asymptomatic and infectious, <span class="math notranslate nohighlight">\(M_i\)</span> for mildly symptomatic and infectious, <span class="math notranslate nohighlight">\(ER_i\)</span> for emergency room and/or buffer ward, <span class="math notranslate nohighlight">\(C_i\)</span> for cohort, <span class="math notranslate nohighlight">\(C_{\text{ICU,rec,i}}\)</span> for a recovery stay in Cohort coming from Intensive Care, <span class="math notranslate nohighlight">\(ICU_i\)</span> for Intensive Care Unit, <span class="math notranslate nohighlight">\(D_i\)</span> for dead and <span class="math notranslate nohighlight">\(R_i\)</span> for recovered. Using the above notation, all model states are 9x1 vectors,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
     \mathbf{S} = [S_1(t)\ S_2(t)\ ...\ S_i(t)]^T,
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(S_i(t)\)</span> denotes the number of susceptibles in age-class i at time t after the introduction of the virus in the population.</p>
<p>These equations are implemented in the function <code class="docutils literal notranslate"><span class="pre">COVID19_SEIRD</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/models.py</span></code>. The integration is performed in <code class="docutils literal notranslate"><span class="pre">_sim_single</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/base.py</span></code> by using Scipy’s <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>. The integrator timestep depends on the rate of change of the system and the solver method is thus referred to as a ‘continuous-time’ solver. The implementation uses non-integer individuals.</p>
</div>
<div class="section" id="stochastic-framework">
<h3>Stochastic framework<a class="headerlink" href="#stochastic-framework" title="Permalink to this headline">¶</a></h3>
<p>By defining the probabilities of transitioning (propensities) from one state to another, a system of coupled stochastic difference equations (SDEs) can be obtained. The probability to transition from one state to another is assumed to be exponentially distributed. As an example, consider the average time a patient spends in an ICU when recovering, which is <span class="math notranslate nohighlight">\(d_{\text{ICU,R}} = 9.9\)</span> days. The chances of survival in ICU are <span class="math notranslate nohighlight">\((1-m_{\text{ICU,i}})\)</span>, where <span class="math notranslate nohighlight">\(m_{\text{ICU,i}}\)</span> is the mortality in ICU for an individual in age group <span class="math notranslate nohighlight">\(i\)</span>. The probability of transitioning from state ICU to state <span class="math notranslate nohighlight">\(C_{\text{ICU,rec}}\)</span> on any given day and for an individual in age group <span class="math notranslate nohighlight">\(i\)</span> is,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
P(ICU_i \rightarrow C_{\text{ICU,rec,i}}) = 1 - \text{exp} \Bigg[ - \frac{1-m_{\text{ICU},i}}{d_{\text{ICU,R}}}\Bigg].
\end{equation}
\]</div>
<p>If a transitioning between states is defined as “succes”, we can regard the number of individuals transitioning from ICU to a Cohort recovery ward as a binomial experiment. On a given day, the number of individuals transitioning is,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
(\text{ICU}_i \rightarrow C_{\text{ICU,rec,i}})(k) \sim \text{Binomial}\Bigg(\text{ICU}_i(k),\ 1 - \text{exp}\Bigg[- \frac{1-m_{\text{ICU,i}}}{d_{\text{ICU,R}}}\Bigg]\Bigg). 
\end{equation}
\]</div>
<p>For a discrete stepsize <span class="math notranslate nohighlight">\(l\)</span>, there are 15 possible transitions,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
(S_i \rightarrow E_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(S_i(k), 1 - \text{exp}\Bigg[- l \beta s_i \sum_{j=1}^{N} N_{c,ij} S_j \Big( \frac{I_j+A_j}{T_j} \Big) \Bigg]\Bigg)\\
(E_i \rightarrow I_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(E_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1}{\sigma}\Bigg]\Bigg)\\
(I_i \rightarrow A_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(I_i(k), 1 - \text{exp}\Bigg[- l\ \frac{a_i}{\omega}\Bigg]\Bigg)\\
(I_i \rightarrow M_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(I_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1-a_i}{\omega}\Bigg]\Bigg)\\
(A_i \rightarrow R_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(A_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1}{d_a}\Bigg]\Bigg)\\
(M_i \rightarrow R_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(M_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1-h_i}{d_m}\Bigg]\Bigg)\\
(M_i \rightarrow ER_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(M_i(k), 1 - \text{exp}\Bigg[- l\ \frac{h_i}{d_{\text{hospital}}}\Bigg]\Bigg)\\
(ER_i \rightarrow C_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(ER_i(k), 1 - \text{exp}\Bigg[- l\ \frac{c_i}{d_{\text{ER}}}\Bigg]\Bigg)\\
(ER_i \rightarrow ICU_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(ER_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1-c_i}{d_{\text{ER}}}\Bigg]\Bigg)\\
(C_i \rightarrow R_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(C_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1-m_{C,i}}{d_{C,R}}\Bigg]\Bigg)\\
(ICU_i \rightarrow C_{\text{ICU,rec,i}}) (k) &amp;\sim&amp; \text{Binomial}\Bigg(ICU_i(k), 1 - \text{exp}\Bigg[- l\ \frac{1-m_{\text{ICU,i}}}{d_{ICU,R}}\Bigg]\Bigg)\\
(C_{\text{ICU,rec,i}} \rightarrow R_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(C_{\text{ICU,rec,i}}(k), 1 - \text{exp}\Bigg[- l\ \frac{1}{d_{\text{ICU,rec}}}\Bigg]\Bigg)\\
(C_i \rightarrow D_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(C_i(k), 1 - \text{exp}\Bigg[- l\ \frac{m_{C,i}}{d_{C,D}}\Bigg]\Bigg)\\
(ICU_i \rightarrow D_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(ICU_i(k), 1 - \text{exp}\Bigg[- l\ \frac{m_{\text{ICU,i}}}{d_{\text{ICU,D}}}\Bigg]\Bigg)\\
(R_i \rightarrow S_i) (k) &amp;\sim&amp; \text{Binomial}\Bigg(R_i(k), 1 - \text{exp}\Bigg[- l\ \zeta \Bigg]\Bigg)\\
\end{eqnarray}
\end{split}\]</div>
<p>And the system of equations becomes,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
S_i(k+1) &amp;=&amp; S_i(k) + (R_i \rightarrow S_i) (k) - (S_i \rightarrow E_i) (k) \\
E_i(k+1) &amp;=&amp; E_i(k) + (S_i \rightarrow E_i) (k) - (E_i \rightarrow I_i) (k) \\
I_i(k+1) &amp;=&amp; I_i(k) + (E_i \rightarrow I_i) (k) - (I_i \rightarrow A_i) - (I_i \rightarrow M_i) (k) \\
A_i(k+1) &amp;=&amp; A_i(k) + (I_i \rightarrow A_i) (k) - (A_i \rightarrow R_i) (k) \\
M_i(k+1) &amp;=&amp; M_i(k) + (I_i \rightarrow M_i) (k) - (M_i \rightarrow R_i) (k) - (M_i \rightarrow ER_i) (k) \\
ER_i(k+1) &amp;=&amp; ER_i(k) + (M_i \rightarrow ER_i) (k) - (ER_i \rightarrow C_i) (k) - (ER_i \rightarrow ICU_i) (k) \\
C_i(k+1) &amp;=&amp; C_i(k) + (ER_i \rightarrow C_i) (k) - (C_i \rightarrow R_i) (k) - (C_i \rightarrow D_i) (k) \\
C_{\text{ICU,rec,i}}(k+1) &amp;=&amp; C_{\text{ICU,rec,i}}(k)  + (ICU_i \rightarrow C_{\text{ICU,rec,i}}) (k) - (C_{\text{ICU,rec,i}} \rightarrow R_i) (k) \\
R_i(k+1) &amp;=&amp; R_i(k) + (A_i \rightarrow R_i) (k)  + (M_i \rightarrow R_i) (k) + (C_i \rightarrow R_i) (k)\\
&amp;&amp; + (C_{\text{ICU,rec,i}} \rightarrow R_i) (k)  - (R_i \rightarrow S_i) (k) \\
D_i(k+1) &amp;=&amp; D_i(k) + (ICU_i \rightarrow D_i) (k) + (C_i \rightarrow D_i) (k) \\
\end{eqnarray}
\end{split}\]</div>
<p>These equations are implemented in the function <code class="docutils literal notranslate"><span class="pre">COVID19_SEIRD_sto</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/models.py</span></code>. The computation itself is performed in the function <code class="docutils literal notranslate"><span class="pre">solve_discrete</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/base.py</span></code>. Please note that the deterministic model uses <strong>differentials</strong> in the model defenition and must be integrated, while the stochastic model uses <strong>differences</strong> and must be iterated. The discrete timestep is fixed at one day. The stochastic implementation only uses integer individuals, which is considered an advantage over the deterministic implementation.</p>
</div>
</div>
<div class="section" id="stochastic-spatial-framework">
<h2>Stochastic spatial framework<a class="headerlink" href="#stochastic-spatial-framework" title="Permalink to this headline">¶</a></h2>
<p><em>Disclaimer: preliminary and subject to changes</em></p>
<p align="center">
<img src="_static/figs/mild_cases_cluster_aarlen.gif" alt="drawing" width="400"/>
<p><em> Percentage of arrondissement population experiencing mild COVID-19 symptoms. Simulation started with cluster located in arrondissement Aarlen, in Belgiums far southeast. A total of 250 days are simulated. Non-calibrated spatial model, meant for explanatory purposes. </em></p>
</p>
<p>We built upon the stochastic national-level model to take spatial heterogeneity into account. The Belgian territory is divided into 43 arrondissements, which are from hereon referred to as <em>patches</em>. Our patch-model boils down to a simulation of the extended SEIRD model dynamics on each patch, where the patches are connected by commuting traffic. This takes the form of a 43x43 from-to commuting matrix, <code class="docutils literal notranslate"><span class="pre">place</span></code>, extracted from the 2011 Belgian census. The system of equations is identical to the national level model, for a resident of age group i in patch g,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
S_{i,g}(k+1) &amp;=&amp; S_{i,g}(k) + (R_{i,g} \rightarrow S_{i,g}) (k) - (S_{i,g} \rightarrow E_{i,g}) (k) \\
E_{i,g}(k+1) &amp;=&amp; E_{i,g}(k) + (S_{i,g} \rightarrow E_{i,g}) (k) - (E_{i,g} \rightarrow I_{i,g}) (k) \\
I_{i,g}(k+1) &amp;=&amp; I_{i,g}(k) + (E_{i,g} \rightarrow I_{i,g}) (k) - (I_{i,g} \rightarrow A_{i,g}) - (I_{i,g} \rightarrow M_{i,g}) (k) \\
A_{i,g}(k+1) &amp;=&amp; A_{i,g}(k) + (I_{i,g} \rightarrow A_{i,g}) (k) - (A_{i,g} \rightarrow R_{i,g}) (k) \\
M_{i,g}(k+1) &amp;=&amp; M_{i,g}(k) + (I_{i,g} \rightarrow M_{i,g}) (k) - (M_{i,g} \rightarrow R_{i,g}) (k) - (M_{i,g} \rightarrow ER_{i,g}) (k) \\
ER_{i,g}(k+1) &amp;=&amp; ER_{i,g}(k) + (M_{i,g} \rightarrow ER_{i,g}) (k) - (ER_{i,g} \rightarrow C_{i,g}) (k) - (ER_{i,g} \rightarrow ICU_{i,g}) (k) \\
C_{i,g}(k+1) &amp;=&amp; C_{i,g}(k) + (ER_{i,g} \rightarrow C_{i,g}) (k) - (C_{i,g} \rightarrow R_{i,g}) (k) - (C_{i,g} \rightarrow D_{i,g}) (k) \\
C_{\text{ICU,rec,i,g}}(k+1) &amp;=&amp; C_{\text{ICU,rec,i,g}}(k)  + (ICU_{i,g} \rightarrow C_{\text{ICU,rec,i,g}}) (k) - (C_{\text{ICU,rec,i,g}} \rightarrow R_{i,g}) (k) \\
R_{i,g}(k+1) &amp;=&amp; R_{i,g}(k) + (A_{i,g} \rightarrow R_{i,g}) (k)  + (M_{i,g} \rightarrow R_{i,g}) (k) + (C_{i,g} \rightarrow R_{i,g}) (k)\\
&amp;&amp; + (C_{\text{ICU,rec,i,g}} \rightarrow R_{i,g}) (k)  - (R_{i,g} \rightarrow S_{i,g}) (k) \\
D_{i,g}(k+1) &amp;=&amp; D_{i,g}(k) + (ICU_{i,g} \rightarrow D_{i,g}) (k) + (C_{i,g} \rightarrow D_{i,g}) (k) \\
\end{eqnarray}
\end{split}\]</div>
<p>Differing only in the chance of infection <span class="math notranslate nohighlight">\((S_{i,g} \rightarrow E_{i,g}) (k)\)</span>. All other possible transitions are dependent on the disease dynamics and not on the spatial coordinate of the individual. If the individual works within his own patch, the individual is assumed to have contacts with people from within his home patch only. The interaction matrix for individuals working in their residence patch is the sum of home, school, work, leisure and other human-to-human interactions per day. If the individual does not work in his home patch, the work vs home, school, leisure, other human-to-human contacts must be seperated,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
    P(S_{i,g} \rightarrow E_{i,g}) (k) &amp;=&amp; 1 - \text{exp} \Bigg[ \underbrace{\text{place}_{g,g} \Bigg\{ - l \beta s_i \sum_{j=1}^{N} N_{\text{c, tot, ij}} S_{j,g} \Bigg( \frac{I_{j,g} + A_{j,g}}{T_{j,g}} \Bigg) \Bigg\}}_{\text{individual working in residence patch}}  \\
    &amp;+&amp; \sum_{l=1\\ l \neq g}^{G} \text{place}_{g,l} \Bigg\{ \underbrace{- l \beta s_i \sum_{j=1}^{N} N_{\text{c, work, ij}} S_{j,l} \Bigg( \frac{I_{j,l} + A_{j,l}}{T_{j,l}} \Bigg)}_{\text{work interactions in work patch (subscript l)}} \\
     &amp;-&amp; \underbrace{l \beta s_i \sum_{j=1}^{N} (N_{\text{c, home, ij}} + N_{\text{c, school, ij}} + N_{\text{c, leisure, ij}} + N_{\text{c, others, ij}}) S_{j,g} \Bigg( \frac{I_{j,g} + A_{j,g}}{T_{j,g}} \Bigg)}_{\text{all other interactions in home patch (subscript g)}} \Bigg\} \Bigg]
\end{eqnarray}
\end{split}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(i \in \big\{0, 1, ..., N\big\}\)</span> where N is the number of age groups (9).</p></li>
<li><p><span class="math notranslate nohighlight">\(g \in \big\{0, 1, ..., G\big\}\)</span> where G is the number of arrondissements (43).</p></li>
</ul>
<p>These equations are implemented in the function <code class="docutils literal notranslate"><span class="pre">COVID19_SEIRD_sto_spatial</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/models.py</span></code>. The computation itself is performed in the function <code class="docutils literal notranslate"><span class="pre">solve_discrete</span></code> located in <code class="docutils literal notranslate"><span class="pre">src/covid19model/base.py</span></code>. Please note that the deterministic model uses <strong>differentials</strong> in the model defenition and must be integrated, while the stochastic model uses <strong>differences</strong> and must be iterated. The discrete timestep is fixed at one day. The stochastic implementation only uses integer individuals, which is considered an advantage over the deterministic implementation.</p>
</div>
<div class="section" id="transmission-rates-and-social-contact-data">
<h2>Transmission rates and social contact data<a class="headerlink" href="#transmission-rates-and-social-contact-data" title="Permalink to this headline">¶</a></h2>
<p>In our model, the transmission rate of the disease depends on the product of four contributions. The first contribution, <span class="math notranslate nohighlight">\((I+A)/T\)</span>, is the fraction of contagious individuals in the population. The second contribution, <span class="math notranslate nohighlight">\(\mathbf{N}_c\)</span>, is the average number of human-to-human interactions per day. The third contribution, <span class="math notranslate nohighlight">\(s_i\)</span>, is the relative susceptiblity to SARS-CoV-2 infection in age group <span class="math notranslate nohighlight">\(i\)</span>, and the fourth contribution, <span class="math notranslate nohighlight">\(\beta\)</span>, is the probability of contracting COVID-19 when encountering a contagious individual under the assumption of 100 % susceptibility to SARS-CoV-2 infection. We assume that the per contact transmission probability <span class="math notranslate nohighlight">\(\beta\)</span> is independent of age and we will infer its distribution by calibrating the model to national Belgian hospitalization data. The number of human-human interactions, <span class="math notranslate nohighlight">\(\mathbf{N}_c\)</span>, are both place and age-dependent. These matrices assume the form of a 9x9 <em>interaction matrix</em> where an entry X, Y denotes the number of social contacts age group X has with age group Y per day. These matrices are available for homes, schools, workplaces, in public transport, and leisure activities, from a survey study by Lander Willem (2012). The total number of social interactions is given by the sum of the contributions in different places,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}\label{eq:interaction_matrices}
\mathbf{N_{\text{c}}} = \mathbf{N_{\text{c, home}}} + \mathbf{N_{\text{c, schools}}} + \mathbf{N_{\text{c, work}}} + \mathbf{N_{\text{c, transport}}} + \mathbf{N_{\text{c, leisure}}} + \mathbf{N_{\text{c, others}}}.
\end{equation}
\]</div>
<p>Coefficients can be added to the contributing contact matrices to model a goverment policy. For instance, to model the Belgian lockdown, the mobility reductions deduced from the Google community mobility reports were used as coefficients for the different interaction matrices. We assumed workplace interactions were down to only 40 % of their prepandemic values before the lockdown.</p>
</div>
<div class="section" id="modeling-social-intertia">
<h2>Modeling social intertia<a class="headerlink" href="#modeling-social-intertia" title="Permalink to this headline">¶</a></h2>
<p>The model takes into account the effect of <em>social inertia</em> when measures are taken. In reality, social restrictions or relaxations represent a change in behaviour which is gradual and cannot be modeled using a step-wise change of the social interaction matrix <span class="math notranslate nohighlight">\(\mathbf{N_c}\)</span>. This can be seen when closely inspecting the <em>Google community mobility report</em> above. Multiple functions can be used to model the effects of social compliance, e.g. a delayed or non-delayed ramp, or a logistic function. In our model, we use a delayed ramp to model compliance,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\mathbf{N_{c}}^{k} = \mathbf{N_{\text{c, old}}} + f^{k} (\mathbf{N_{\text{c, new}}} - \mathbf{N_{\text{c, old}}})
\end{equation}
\]</div>
<p>where,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
    f^k= 
\begin{cases}
	0.0,&amp; \text{if } k\leq \tau\\
    \frac{k}{l} - \frac{\tau}{l},&amp; \text{if } \tau &lt; k\leq \tau + l\\
    1.0,              &amp; \text{otherwise}
\end{cases}
\end{equation}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\tau\)</span> is the number of days before measures start having an effect and <span class="math notranslate nohighlight">\(l\)</span> is the number of additional days after the time delay until full compliance is reached. Both parameters were calibrated to the daily number of hospitalizations in Belgium (notebooks <code class="docutils literal notranslate"><span class="pre">notebooks/0.1-twallema-calibration-deterministic.ipynb</span></code> and <code class="docutils literal notranslate"><span class="pre">notebooks/0.1-twallema-calibration-stochastic.ipynb</span></code>). <span class="math notranslate nohighlight">\(k\)</span> denotes the number of days since a change in social policy.</p>
</div>
<div class="section" id="basic-reproduction-number">
<h2>Basic reproduction number<a class="headerlink" href="#basic-reproduction-number" title="Permalink to this headline">¶</a></h2>
<p>The basic reproduction number <span class="math notranslate nohighlight">\(R_0\)</span>, defined as the expected number of secondary cases directly generated by one case in a population where all individuals are susceptible to infection, is computed using the next generation matrix (NGM) approach introducted by Diekmann. For our model, the basic reproduction number of age group <span class="math notranslate nohighlight">\(i\)</span> is,</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}\label{eq:reproduction_number}
R_{0,i} = (a_i d_a + \omega) \beta s_i \sum_{j=1}^{N} N_{c,ij}
\end{equation}
\]</div>
<p>and the population basic reproduction number is calculated as the weighted average over all age groups using the demographics of Belgium. The detailed algebra underlying the computation equation of the basic reproduction number is presented in the supplementary materials of our manuscript (see section <em>Previous work</em>).</p>
</div>
<div class="section" id="model-parameters">
<h2>Model parameters<a class="headerlink" href="#model-parameters" title="Permalink to this headline">¶</a></h2>
<p>An in-depth motivation of the model parameters is provided in our manuscript (see section <em>Previous work</em>). Hospital parameters were derived from a dataset obtained from two hospitals in Ghent (Belgium).</p>
<p align="center">
<img src="_static/figs/parameters.png" alt="parameters" width="1200"/>
<em> Overview of BIOMATH COVID-19 model parameters. </em>
</p></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="application.html" class="btn btn-neutral float-right" title="How to use the model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="git_workflow.html" class="btn btn-neutral float-left" title="Git workflow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Biomath

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>